# 增强型文本块划分系统

本项目针对通信领域的专业文档，提供了一种优化的文本块划分方法，以提高RAG系统的检索精度和理解能力。

## 项目背景

传统的文本块划分方法（如固定字符数或固定句子数分割）往往无法很好地保留文档的语义结构和富文本特性，导致：

1. 上下文信息丢失
2. 图表与相关文本分离
3. 标题与内容脱节
4. 复杂表格的格式失真

本项目旨在提供一种智能的、结构感知的文本块划分方法，特别针对通信领域的专业文档进行了优化。

## 核心策略

我们的文本块划分系统采用了分层递归的方式，结合了以下核心策略：

### 1. 结构感知分割

- **语义边界识别**：根据文档结构（标题、段落、列表、表格等）进行分割
- **标题级别感知**：使用标题层级（h1,h2,h3等）作为主要分割点，保留文档的原始组织结构
- **标题元数据保存**：将每个文本块关联到其所属的标题路径，便于上下文重建

### 2. 富文本保留

- **表格完整性**：识别并保留完整表格，避免表格被拆分
- **图片处理**：提取图片并生成描述，与相关文本关联
- **格式信息**：保留必要的格式信息（粗体、斜体、列表等）

### 3. 多模态处理

- **图片处理**：使用OCR和图像描述技术处理图片内容
- **表格结构化**：将表格转换为结构化格式，便于模型理解
- **多模态融合**：整合文本、图像和表格信息，创建更全面的检索单元

### 4. 智能分块策略

- **自适应块大小**：根据内容复杂度和语义完整性动态调整块大小
- **重叠分块**：采用滑动窗口增加相邻块间的内容重叠，减少信息丢失
- **语义分块**：结合向量表示模型，确保分块在语义上的连贯性

## 技术实现

我们的系统主要包括以下组件：

1. **文档解析器**：基于Unstructured.io的文档解析能力，提取文档的结构化信息
2. **文本分块器**：实现结构感知的文本分块逻辑
3. **表格处理器**：保持表格完整性，同时支持Markdown格式的表格表示
4. **图像处理器**：处理图像内容，生成文本描述
5. **元数据管理器**：管理块级元数据，包括标题路径、原始位置、图像引用等

## 适用场景

该系统特别适用于以下场景：

- 包含丰富表格和图片的通信领域专业文档
- 需要保留文档结构进行精确问答的场景
- 需要对复杂格式（如表格、图表）进行理解的应用
- 需要维持源文档关联性的长文档处理

## 优势

与传统分块方法相比，我们的系统具有以下优势：

1. **更高的语义完整性**：保留文档的逻辑结构和语义关系
2. **富媒体处理能力**：适当处理图片和表格等非文本元素
3. **元数据增强**：通过保留文档结构元数据，提高检索精度
4. **自适应分块**：根据内容特性智能调整分块策略 